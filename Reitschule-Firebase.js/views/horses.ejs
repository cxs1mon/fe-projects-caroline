<!DOCTYPE html>
<html>
  <head>
    <title>Horse Management</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    />
  </head>
  <body>
    <table class="table w-75">
      <tr>
        <th>Name</th>
        <th>Alter</th>
        <th>Farbe</th>
        <th>Rasse</th>
        <th></th>
      </tr>
      <% horses.forEach(horse => { %>
      <tr>
        <td><%= horse.name %></td>
        <td><%= horse.age %></td>
        <td><%= horse.color %></td>
        <td><%= horse.breed %></td>
        <td><button>Edit</button><button class="btn delete-btn" data-id="<%= horse.id %>">Delete</button></td>
      </tr>
      <% }); %>
    </table>

    <button>New Horse</button>
    <button>Delete All</button>

    <!-- TODO: Horses List -->
    <!-- TODO: Add Horse Form -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', (event) => {
        const delete_btns = document.querySelectorAll(".delete-btn");
        delete_btns.forEach(element => {
          element.addEventListener("click", () => {
            const horseId = element.getAttribute("data-id");
    
            // Send delete request to server
            fetch(`/delete/${horseId}`, {
              method: 'DELETE'
            })
            .then(response => {
              if (response.ok) {
                alert("Horse deleted successfully!");
              } else {  
                alert("Failed to delete horse.");
              }
            })
            .catch(error => {
              console.error("Error deleting horse: ", error);
              alert("Error deleting horse. Please try again.");
            });
          });
        });
      });
    </script>
  </body>
</html>
